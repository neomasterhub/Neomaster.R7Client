# R7 Client
–ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API "–†7-–û—Ñ–∏—Å. –°–µ—Ä–≤–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤".

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÑ **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PDF:**
  - –§–æ—Ä–º–∞—Ç—ã –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: `doc`, `docx`, `xls`, `xlsx`.
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫, –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª–æ–≤, –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —Ñ–æ—Ä–º—É–ª.
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Å—à—Ç–∞–±–∞ –∏ –ø–æ–¥–≥–æ–Ω–∫–∞ –ø–æ–¥ –ø–µ—á–∞—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ª–∏—Å—Ç–∞.

- üîê **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
  - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ JWT, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π HMAC-—Å–µ–∫—Ä–µ—Ç–æ–º.
  - –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ç–æ–∫–µ–Ω–∞.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ["–†7-–û—Ñ–∏—Å. –°–µ—Ä–≤–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"](https://support.r7-office.ru/document_server/install-document_server/ds_docker/docker_install_ds/).

2. –î–æ–±–∞–≤–∏—Ç—å [NuGet-–ø–∞–∫–µ—Ç](https://www.nuget.org/packages/Neomaster.R7Client).

```bash
dotnet add package Neomaster.R7Client
```
3. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é –≤ `appsettings.json`:

```json
"R7ApiSettings": {
  "ConvertUrl": "http://localhost:59001/ConvertService.ashx",
  "Secret": "eGzvoLPMEIJnGYEBIb30N8GvodOBnoJF"
},
"WorkingDirectory": "D:/r7/conversion"
```
- –ó–Ω–∞—á–µ–Ω–∏–µ `Secret` –∑–∞–¥–∞–Ω–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `services.CoAuthoring.secret.inbox.string`
  –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Ñ–∞–π–ª–µ `/etc/r7-office/documentserver/local.json`.
- `WorkingDirectory` - —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

4. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
```csharp
builder.Services.AddR7Client(builder.Configuration);
builder.Services.AddMemoryCache(); // –ë—É—Ñ–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
```

## üîç –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Word

```json
{
  "fileName": "docx-01.docx",
  "inputType": "Docx",
  "outputType": "Pdfa"
}
```

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel

* –õ–∏—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∞ –ê4 –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏.
* –£–∂–∏–º–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ —à–∏—Ä–∏–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
```json
{
  "fileName": "xlsx-01.xlsx",
  "inputType": "Xlsx",
  "outputType": "Pdfa",
  "spreadsheetLayout": {
    "pageSize": {
      "width": "29.7cm",
      "height": "21cm"
    },
    "margins": {
      "left": "1cm",
      "right": "1cm",
      "top": "1cm",
      "bottom": "1cm"
    },
    "fitToWidth": 1
  }
}
```

## üìÖ –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

- [x] –†–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- [ ] –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.
- [ ] –ü—Ä–∏–º–µ—Ä—ã –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.
- [ ] –ë—É—Ñ–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.
      –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - memory cache.
- [ ] –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é.
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é.

## ‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

- üåê –í –∫–æ–º–ø–ª–µ–∫—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –µ—Å—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ - **Neomaster.R7Client.Api**.
- üìñ [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏](https://support.r7-office.ru/document_server/api-document_server/more_api/conversion-api/)
